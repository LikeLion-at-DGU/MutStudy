{% extends 'base.html' %}
{% load static %}

{% block content %}
<style>
    /* h1 {
  padding: 0.7rem;
  border-left: 5px solid rgb(113, 127, 247);
  background: #dee3ff;
} */
    .first_a{
        border: 2px solid none;
        background-color: rgb(113, 127, 247);
        padding: 4px 7px;        
        border-radius: 10px;
        text-decoration: none;
        color: whitesmoke;

    }
    a:hover{
        color: black;
    }
    .postImage{
        width: 300px;
        border-radius: 20px;
    }

    .end_a
    {
        text-decoration: none;
        color: whitesmoke;
    }
    button{
      background:#435ac0;
      color:#fff;
      border:none;
      position:relative;
      height:40px;
      font-size:1em;
      padding:0 20px;
      cursor:pointer;
      transition:800ms ease all;
      outline:none;
    }
    button:hover{
      background:rgb(160, 174, 255);
      color:#435ac0;
    }
    button:before,button:after{
      content:'';
      position:absolute;
      top:0;
      right:0;
      height:2px;
      width:0;
      background: #435ac0;
      transition:400ms ease all;
    }
    button:after{
      right:inherit;
      top:inherit;
      left:0;
      bottom:0;
    }
    button:hover:before,button:hover:after{
      width:100%;
      transition:800ms ease all;
    }
    .titleBox{
        border-radius: 5em; 
        padding: 0.6em 1em; 
        background: #ffffff; 
        box-shadow: 1px 2px 10px rgba(0,0,0,0.2);  
        margin-left: 5px;
    }
    .bodyBox{
        border-radius: 1em; 
        padding: 0.6em 1em; 
        background: #ffffff; 
        box-shadow: 1px 2px 10px rgba(0,0,0,0.2);  
        margin-left: 5px;
    }
</style>
<section style="margin: 20px; margin-left: 35px; margin-top: 30px;">
    <h1 class="titleBox">스터디명 : {{post.name}}</h1>
    <br>
    <div class="bodyBox">
    <h5 style="display: inline;">작성자 :</h5> <a class="first_a" href="{% url 'mypage:mypage' post.writer.id %}" >{{post.writer}}</a>&nbsp;&nbsp;&nbsp;&nbsp;
    <p style="margin: 6px 0px;"><h5 style="display: inline;"> 스터디장 연락처 :</h5> {{post.phnum}}<br></p>
    <!-- <p style="display: inline; float: right;">스터디장 연락처: {{post.phnum}}<br></p> -->
    <!-- 개인정보,,, -->
    <hr>
    <h5 style="display: inline;">스터디 분야 :</h5> {{post.section}}<br>
    <h5 style="display: inline;">모집 대상:</h5> {{post.qualification}} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <h5 style="display: inline;">스터디 모집 인원 : </h5>{{post.member_start}} ~ {{post.member_end}}<br>
    <hr>
    <h5 style="display: inline;">한줄 소개 :</h5> {{post.intro}} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <h5 style="display: inline;"> 스터디 난이도 : </h5>{{post.difficulty}}<br>
    <hr>

    <div class="bodyBox">
        <h3>스터디 정보</h3> {{post.body}}
        <br><br>
        {%if post.image%}
        <h3>관련 이미지</h3> 
        <img class="postImage" src="{{ post.image.url }}"  alt="사진 나올 곳"><br>
    {%endif%}
    </div>
    
    {%if not post.is_over%}
    <!-- 글 작성자가 마감하기 전이라면 -->
        {%if is_author%}
        <!-- 접속자가 글 작성자라면 -->
            {%if post.study_member_request%}
            <!-- 그리고 혹시 지금 스터디 지원한 사람이 있다면 -->
                {%for member in post.study_member_request.all%}
                <!-- 지원한 사람 for문으로 꺼내고 수락 / 거절 -->
                    {{member}}
                    <a href="{% url 'study:accept_request' post.id member.id %}">수락</a>
                    <a href="{% url 'study:refuse_request' post.id member.id %}">거절</a><br>
                {%endfor%}
            {%else%}
            <!-- 지원한 사람이 없다면 -->
                <strong>지원자 아직 없음!</strong><br>
            {%endif%}
        {%else%}
        <!-- 접속자가 글 작성자가 아니라면 -->
            {%if request.user in post.study_member.all%}
            <!-- 접속자가 스터디에 가입돼 있으면 -->
                <strong>해당 스터디에 가입돼 있습니다!</strong>
            {%elif request.user in post.study_member_request.all%}
            <!-- 접속자가 스터디에 가입 신청을 넣은 상태라면 -->
                <strong>승인 대기 중입니다.</strong>
                <a href="{% url 'study:apply_study' post.id %}">지원취소</a><br>
            {%elif request.user.is_authenticated %}
            <!-- 어느 케이스에도 해당 안되고 로그인이 돼 있다면 -->
                <a href="{% url 'study:apply_study' post.id %}">지원하기</a><br>
            {%endif%}
        {%endif%}
    {%else%}<hr>
        <h1>마감!!!!!!!!!</h1>
    {%endif%}
    {%if request.user in post.study_member.all%}
    <!-- 접속자가 스터디에 가입 완료돼있으면 -->
    <hr>
        현재 가입 멤버들:
        {%for member in post.study_member.all%}

        <a class ="first_a" href="{% url 'mypage:mypage' member.id %}">{{member}}</a>
        {%endfor%}
        <p >활동 기간: {{post.start_date}} ~ {{post.due_date}}</p>
    {%endif%}
    {%if is_author%}
    <!-- 접속자가 글 작성자라면 -->
        {%if not post.is_over%}
        <!-- 마감하기 전 글이라면 -->
    </div>
    <br>
            <button><a class="end_a" href="{% url 'study:edit' post.id %}">수정하기</a></button>
            <button><a class="end_a" href="{% url 'study:delete' post.id %}">삭제하기</a></button>
            <button><a class="end_a" href="{% url 'study:recruit_over' post.id%}">마감하기</a></button>
        {%endif%}
    {%endif%}
</section>
{% endblock %}

